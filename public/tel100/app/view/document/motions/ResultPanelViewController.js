/*
 * File: app/view/document/motions/ResultPanelViewController.js
 *
 * This file was generated by Sencha Architect version 3.2.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 5.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 5.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('Tel100.view.document.motions.ResultPanelViewController', {
  extend: 'Ext.app.ViewController',
  alias: 'controller.documentmotionsresultpanel',

  onSaveClick: function(button, e, eOpts) {
    var view = this.getView();
    var vm = this.getViewModel();

    var params = {
      document_id: vm.get('document').id,
      motion_id: vm.get('motionId'),
      is_result: vm.get('isResult'),
      text: vm.get('text')
    };
    if (params.is_result) { params.category_id = vm.get('categoryId'); }
    if (typeof params.motion_id !== 'number') { params.motion_id = null; }

    if (!params.is_result && !params.text){
      Ext.Msg.show({
        title: i18n.document.comment.errors.text_required_title,
        message: i18n.document.comment.errors.text_required,
        buttons: Ext.Msg.OK,
      });
      return;
    }

    helpers.api.document.comment.create({
      params: params,
      success: function(data) {
        debugger;
      }
    });
  },

  onMotionsStoreLoad: function(store, records, successful, eOpts) {
    var view = this.getView();
    var combo = view.down('#in-motions');
    var val = store.getAt(0);
    combo.select(val);
  },

  onResponseTypesStoreLoad: function(store, records, successful, eOpts) {
    var view = this.getView();
    var combo = view.down('#result-types');
    var val = store.getAt(0);
    combo.select(val);
  }

});
