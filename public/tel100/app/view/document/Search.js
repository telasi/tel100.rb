/*
 * File: app/view/document/Search.js
 *
 * This file was generated by Sencha Architect version 3.2.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 5.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 5.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('Tel100.view.document.Search', {
  extend: 'Ext.window.Window',
  alias: 'widget.documentsearch',

  requires: [
    'Tel100.view.document.SearchViewModel',
    'Tel100.view.document.folder.Search',
    'Tel100.view.document.grid.Panel',
    'Ext.form.Panel',
    'Ext.grid.Panel'
  ],

  viewModel: {
    type: 'documentsearch'
  },
  height: 400,
  width: 800,
  layout: 'border',
  closeAction: 'hide',
  defaultListenerScope: true,

  bind: {
    title: '{i18n.document.search.ui.search}'
  },
  items: [
    {
      xtype: 'documentfoldersearch',
      width: 300,
      title: '',
      titleCollapse: false,
      region: 'west',
      split: true
    },
    {
      xtype: 'documentgridpanel',
      region: 'center',
      listeners: {
        itemdblclick: 'onGridpanelItemDblClick'
      }
    }
  ],

  onGridpanelItemDblClick: function(dataview, record, item, index, e, eOpts) {
    var parent = this.getParentDocument();
    if (record.get('status') !== 0 && record.id !== parent.id) {
      this.fireEvent('documentselected', record);
      this.close();
    }
  },

  getParentDocument: function() {
    return this.getViewModel().get('document');
  },

  setParentDocument: function(doc) {
    this.getViewModel().set('document', doc);
  }

});